using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using Pgvector;

namespace SorobanSecurityPortalApi.Models.DbModels
{
    [Table("vulnerability")]
    public class VulnerabilityModel
    {
        [Key] 
        public int Id { get; set; }
        public string Severity { get; set; } = "";
        [Column(TypeName = "jsonb")]
        public List<string>? Tags { get; set; }
        [ForeignKey("Report")]
        public int? ReportId { get; set; }
        public ReportModel? Report { get; set; }
        public string ReportUrl { get; set; } = "";
        public string Title { get; set; } = "";
        public string Description { get; set; } = "";
        public DateTime Date { get; set; }
        public string Status { get; set; } = "";
        public string Author { get; set; } = "";
        public string LastActionBy { get; set; } = "";
        public DateTime LastActionAt { get; set; }
        public string PicturesContainerGuid { get; set; } = "";
        [Column(TypeName = "vector(3072)")]
        public Vector? Embedding { get; set; }
        public VulnerabilityCategory Category { get; set; } = VulnerabilityCategory.NA;
    }

    public class VulnerabilityModelStatus
    {
        public const string New = "new";
        public const string Approved = "approved";
        public const string Rejected = "rejected";
    }

    public class VulnerabilitySeverity
    {
        public const string Critical = "critical";
        public const string High = "high";
        public const string Medium = "medium";
        public const string Low = "low";
        public const string Note = "note";
    }

    public enum VulnerabilityCategory
    {
        Valid = 0,
        ValidNotFixed = 1,
        ValidPartiallyFixed = 2,
        Invalid = 3,
        NA = 100
    }
}