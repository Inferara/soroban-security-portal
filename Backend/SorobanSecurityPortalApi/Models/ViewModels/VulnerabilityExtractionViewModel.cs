namespace SorobanSecurityPortalApi.Models.ViewModels;

/// <summary>
/// Result of a vulnerability extraction operation.
/// </summary>
public class VulnerabilityExtractionResultViewModel
{
    /// <summary>
    /// Total number of vulnerabilities extracted from the report.
    /// </summary>
    public int TotalExtracted { get; set; }

    /// <summary>
    /// Number of new vulnerabilities created in the database.
    /// </summary>
    public int TotalCreated { get; set; }

    /// <summary>
    /// Number of vulnerabilities skipped due to deduplication.
    /// </summary>
    public int DuplicatesSkipped { get; set; }

    /// <summary>
    /// IDs of the newly created vulnerabilities.
    /// </summary>
    public List<int> CreatedVulnerabilityIds { get; set; } = new();

    /// <summary>
    /// Validation warnings from the extraction process.
    /// </summary>
    public List<string> ValidationWarnings { get; set; } = new();

    /// <summary>
    /// Any processing errors that occurred during extraction.
    /// </summary>
    public List<string> ProcessingErrors { get; set; } = new();

    /// <summary>
    /// Total processing time in milliseconds.
    /// </summary>
    public long ProcessingTimeMs { get; set; }
}

/// <summary>
/// Options for vulnerability extraction.
/// </summary>
public class VulnerabilityExtractionOptions
{
    /// <summary>
    /// Maximum number of vulnerabilities to extract.
    /// </summary>
    public int MaxVulnerabilities { get; set; } = 100;
}
